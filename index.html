<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>零时科技</title>

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <meta property="og:type" content="website">
<meta property="og:title" content="零时科技">
<meta property="og:url" content="https://blog.noneage.com/index.html">
<meta property="og:site_name" content="零时科技">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="零时科技">
  
    <link rel="alternative" href="/atom.xml" title="零时科技" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
    
  <meta content="{{ title }}" name="description">
  <meta content="{{ title }}" name="keywords">
  <meta content="{{ title }}" name="author">

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|PT+Sans+Narrow|Source+Sans+Pro:200,300,400,600,700,900&amp;subset=all" rel="stylesheet" type="text/css">

  <!-- Global styles START -->   
  <link rel="stylesheet" href="/metronic/assets/plugins/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/metronic/assets/plugins/bootstrap/css/bootstrap.min.css">
  <!-- Global styles END --> 
   
  <!-- Page level plugin styles START -->
  <link rel="stylesheet" href="/metronic/assets/pages/css/animate.css">
  <link rel="stylesheet" href="/metronic/assets/plugins/owl.carousel/assets/owl.carousel.css">
  <!-- Page level plugin styles END -->

  <!-- Theme styles START -->
  <link rel="stylesheet" href="/metronic/assets/pages/css/components.css">
  <link rel="stylesheet" href="/metronic/assets/pages/css/slider.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/style.css">
  <link rel="stylesheet" href="/metronic/assets/pages/css/portfolio.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/style-responsive.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/themes/red.css">
  <link rel="stylesheet" href="/css/theme-styles.css">
  <!-- Theme styles END -->
</head>
</html>
<body class="corporate">
  <!-- BEGIN TOP BAR -->
<div class="pre-header">
  <div class="container">
    <div class="row">
      <!-- BEGIN TOP BAR LEFT PART -->
      <div class="col-md-6 col-sm-6 col-xs-9 additional-shop-info">
	<ul class="list-unstyled list-inline">
	  <li><i class="fa fa-phone"></i><span>150-2922-9543</span></li>
	  <li><i class="fa fa-envelope-o"></i><span>support@noneage.com</span></li>
	</ul>
      </div>
      <!-- END TOP BAR LEFT PART -->
      <!-- BEGIN TOP BAR MENU -->
      <div class="col-md-6 col-sm-6 col-xs-3 additional-nav">
	<ul class="list-unstyled list-inline pull-right">
	  <!--<li><a href="/login">Log In</a></li>-->
	</ul>
      </div>
      <!-- END TOP BAR MENU -->
    </div>
  </div>        
</div>
<!-- END TOP BAR -->
<!-- BEGIN HEADER -->
<div class="header">
  <div class="container">
    <!--<a class="site-logo" href="/" id="logo">零时科技</a>-->

    <a class="site-logo" href="/">
      <img width="148" hight="42" src="/metronic/assets/corporate/img/logos/noneage_logo_gray.png" alt="noneage blog">
    </a>

    <a href="javascript:void(0);" class="mobi-toggler"><i class="fa fa-bars"></i></a>

    <!-- BEGIN NAVIGATION -->
    <div class="header-navigation pull-right font-transform-inherit">
      <ul>
	
	<li class="active">
	  <a href="/">Home</a>
	</li>
	
	<li class="">
	  <a href="/archives/">Archives</a>
	</li>
	
	<!-- BEGIN TOP SEARCH -->
	<li class="menu-search">
	  <span class="sep"></span>
	  <i class="fa fa-search search-btn"></i>
	  <div class="search-box">
	    <form action="#">
	      <div class="input-group">
		<input type="text" placeholder="Search" class="form-control st-default-search-input">
		<span class="input-group-btn">
		  <button class="btn btn-primary" type="submit">Search</button>
		</span>
	      </div>
	    </form>
	  </div> 
	</li>
	<!-- END TOP SEARCH -->
      </ul>
    </div>
    <!-- END NAVIGATION -->
  </div>
</div>
<!-- Header END -->

  
  <div class="container">
    <ul class="breadcrumb">
      <li class="active">Home</li>
    </ul>
  <div id="main">
    <div class="row">

<div class="col-xs-12 blog-posts">


  <section class="archives-wrap">
    <div class="archives">
      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-App安全·下/">交易所安全测试-App安全·下</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:48:57.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-App安全·下/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	

      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="App安全·下篇"><a href="#App安全·下篇" class="headerlink" title="App安全·下篇"></a>App安全·下篇</h1><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><p>如今，随着人们使用手机，平板等移动端设备上网的时间与频率增加，移动app的发展也是愈来愈迅速。各大交易所在与用户交互的这方面，除了网页浏览以外，也就是移动端的app了。</p>
<p>尽管app时下相当流行，但其安全性却一直没有得到足够的关注。在app安全的领域上，大部分厂商都做得比较初级，很多用户也不具备相对应的安全意识。由此，app也就变成了恶意攻击者的一个有效突破口。</p>
<p>零时科技安全团队在经过大量对app进行的安全测试之后，总结出了一份相对完整有效的测试列表，建议各大交易所以此自查，防患于未然。</p>
<h2 id="二、测试列表"><a href="#二、测试列表" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><p><strong>App安全</strong></p>
<ul>
<li>秘钥硬编码安全检测</li>
<li>数据存储安全检测</li>
<li>数据传输安全检测</li>
<li>日志信息泄露检测</li>
<li>App组件导出检测</li>
<li>App组件权限检测</li>
<li>webview 多项漏洞安全测试</li>
<li>App Webview DOM 安全测试</li>
<li>本地SQL注入安全测试</li>
<li>SQLite 存储安全审计</li>
</ul>
<h2 id="三、案例分析"><a href="#三、案例分析" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="秘钥硬编码安全"><a href="#秘钥硬编码安全" class="headerlink" title="秘钥硬编码安全"></a>秘钥硬编码安全</h3><p>被测试的app，若通信存在加密处理，即可检查源码或者静态资源文件中是否存在硬编码的加密秘钥，从而破解通信加密的数据。</p>
<p>零时科技安全团队在对某交易所app进行安全测试时，检查是否存在秘钥硬编码漏洞，此app请求数据默认是通过请求数据排列，然后加上appkey加上另外一个秘钥进行md5，再通过算法后去字符串再次md5得到最后的签名。</p>
<p>这里加密使用的appkey硬编码到apk中。如下图：</p>
<p><img src="./assets/8.png" alt="image-20191127114336723"></p>
<p>另一个加密key在so文件中，通过逆向可以获取：</p>
<p><img src="./assets/9.png" alt="image-20191127114414440"></p>
<p>这样一来即可通过修改数据后重新签名构造任意数据了，加签也就失去了意义。</p>
<p><em>以下为第二个例子。</em></p>
<p>零时科技安全团队在对另一个app进行测试时，使用burp工具截取该app传输的数据包，发现响应包内容已经过加密并有base64的特征。</p>
<p><img src="./assets/10.png" alt="image-20191127114935210"></p>
<p>对apk进行逆向获取到加密方式为aes cbc补码方式为pkcs7。</p>
<p><img src="./assets/11.png" alt="image-20191127115013311"></p>
<p>在反编译源码中未查询到aes秘钥相关信息 对apk进行解压 在静态资源文件中发现aes_key与aes_iv。</p>
<p><img src="./assets/12.png" alt="image-20191127115132396"></p>
<p>使用收集到的aes_key与aes_iv 以pkcs7为补码方式构造aes cbc解密获取到明文数据。</p>
<h3 id="数据存储安全"><a href="#数据存储安全" class="headerlink" title="数据存储安全"></a>数据存储安全</h3><p>如果安卓手机用户的app文件存放在external storage，例如SD卡，那这些文件就是全局可读写的，external storage可以被任何用户操作，且可以被所有的应用修改使用。</p>
<p>零时科技安全团队在对某交易所app进行安全测试时，使用动态方法监测/data/data/<packagename>/目录下所有生成的目录是否带有明文信息泄露。</packagename></p>
<p>进入到/data/data/com.xxx.wallet/shared_prefs目录，查看config.xml文件，此文件存储了用户的支付信息等非常敏感的信息，而这些信息可被其他用户接触导致信息被盗取等。</p>
<p><img src="./assets/13.png" alt="image-20191127115412109"></p>
<p>零时科技安全团队建议，app的敏感数据不要存放在external storage，如若不得不这样做，请对数据进行加密处理。</p>
<h3 id="日志信息泄露"><a href="#日志信息泄露" class="headerlink" title="日志信息泄露"></a>日志信息泄露</h3><p>在APP的开发过程中，为了方便调试，通常会使用log函数输出一些关键流程的信息，这些信息又通常会包含敏感内容，如执行流程、明文的用户名密码等。这会让攻击者更加容易的了解APP内部结构方便破解和攻击，甚至直接获取到有价值的敏感信息。</p>
<p>零时科技安全团队在对某交易所app进行安全测试时，检测存在漏洞，程序中使用Log.v、Log.d、Log.e、Log.i、Log.w、Log.f、Log.s函数对日志信息输出，在反编译apk后，在源码中查找到日志信息输入接口函数，如下图：</p>
<p><img src="./assets/14.png" alt="image-20191127115855842"></p>
<p>零时科技安全团队建议各大交易所app开发人员移除<br>g打印。</p>
<h3 id="App组件导出检测"><a href="#App组件导出检测" class="headerlink" title="App组件导出检测"></a>App组件导出检测</h3><p>检测app中Activity、activity-alias、service、receiver组件对外暴露情况，如果检测到组件的exported属性为true或者未设置，而且组件的permission属性为normal或者dangerous或者未设置组件的permission属性时，app将存在组件导出漏洞，导致数据泄露和恶意的dos攻击以及钓鱼攻击。</p>
<p>零时科技安全团队在对某交易所app进行安全测试时，检测到该app存在Activity组件导出漏洞。</p>
<p>检æapp中Activity、activity-alias、service、receiver组件对外暴露情况，先检测组件的exported属性，再检测组件的permission对应的protectionlevel属性。</p>
<p><img src="./assets/15.png" alt="image-20191127120209316"></p>
<p>具体检测存在漏洞的方æ如下:</p>
<p><img src="./assets/16.png" alt="image-20191127120236800"></p>
<p>零时科技安全团队建议：</p>
<ul>
<li><p>最小化组件暴露。对不会参与跨应用调用的组件添加android:exported=”false”属性。</p>
</li>
<li><p>设置组件访问权限。对跨应用间调用的iver、service、activity和activity-alias设置权限，同时将权限的protectionLevel设置为”signature”或”signatureOrSystem”。</p>
</li>
<li><p>组件传输数据验证。对组件之间，特别是跨应用的组件之间的数据传入与返回做验证和增加异常处理，防止恶意调试数据传入，更要防止敏感数据返回。</p>
</li>
</ul>
<h3 id="SQLite-存储安全"><a href="#SQLite-存储安全" class="headerlink" title="SQLite 存储安全"></a>SQLite 存储安全</h3><p>此类安全问题的检测，使用adb工具将sqlite数据库拖到本地，使用sqlite数据库连接软件查看是否存在敏感数据即可。如下为零时科技安全团队测试某交易所app发现的漏洞范例。</p>
<p><img src="./assets/17.png" alt="image-20191127113525445"></p>
<hr>
<p>**随着移动互联网的发展，如今移动设备已与我们的生活息息相关，</p>

      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-App安全·下/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-App安全·上/">交易所安全测试-App安全·上</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:48:52.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-App安全·上/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	

      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="0x08App安全·上篇"><a href="#0x08App安全·上篇" class="headerlink" title="0x08App安全·上篇"></a>0x08App安全·上篇</h1><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><p>如今，随着人们使用手机，平板等移动端设备上网的时间与频率增加，移动app的发展也是愈来愈迅速。各大交易所在与用户交互的这方面，除了网页浏览以外，也就是移动端的app了。</p>
<p>尽管app时下相当流行，但其安全性却一直没有得到足够的关注。在app安全的领域上，大部分厂商都做得比较初级，很多用户也不具备相对应的安全意识。由此，app也就变成了恶意攻击者的一个有效突破口。</p>
<p>零时科技安全团队在经过大量对app进行的安全测试之后，总结出了一份相对完整有效的测试列表，建议各大交易所以此自查，防患于未然。</p>
<h2 id="二、测试列表"><a href="#二、测试列表" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><p><strong>App安全</strong></p>
<ul>
<li>App 运行时虚拟机监测</li>
<li>App 运行时root监测</li>
<li>App数据备份检测</li>
<li>代码反编译检测</li>
<li>敏感权限使用</li>
<li>敏感信息泄露</li>
<li>拒绝服务测试</li>
<li>目录穿越安全测试</li>
<li>App 缓存安全检测</li>
<li>接口安全测试</li>
<li>弱加密安全测试</li>
</ul>
<h2 id="三、案例分析"><a href="#三、案例分析" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="App-运行时虚拟机监测"><a href="#App-运行时虚拟机监测" class="headerlink" title="App 运行时虚拟机监测"></a>App 运行时虚拟机监测</h3><p>零时科技在对某交易所进行发现，该交易app未进行虚拟机运行检测，攻击者在虚拟机中安装运行该app，即可在虚拟机中截取并操作数据包或进行其他有害操作。</p>
<p><img src="./assets/1.png" alt="VM DETECT"></p>
<h3 id="App数据备份检测"><a href="#App数据备份检测" class="headerlink" title="App数据备份检测"></a>App数据备份检测</h3><p>零时科技安全团队在对某交易所app进行安全测试时，发现该交易所并未对app进行数据备份检测，安卓AndroidManifest.xml文件中android:allowBackup为true，当这个标志被设置成true或不设置该标志位时，应用程序数据可以备份和恢复，adb调试备份允许恶意攻击者复制应用程序数据。</p>
<p>零时科技安全团队在对某交易所app进行安全测试时，发现该交易所并未对app进行数据备份检测，其AndroidManifest.xml文件中android: allowBackup为true，存在数据任意备份漏洞。</p>
<p><img src="./assets/2.png" alt="Source Code"></p>
<p>连接手机，然后输入以下备份命令，会出现一个对话窗，输入备份密码即可：</p>
<blockquote>
<p>adb backup -nosystem -noshared -apk -f com.xxx.wallet com.xxx.wallet</p>
</blockquote>
<p><img src="./assets/3.png" alt="BACKUP"></p>
<p>连接到另一台手机或root的本机，输入下列命令，弹出对话框，输入备份时的密码即可恢复数据</p>
<blockquote>
<p>adb restore com</p>
</blockquote>
<p>如果用户账号密码保存在本地，则恢复到另一台root的手机后，可以看到各种敏感信息。</p>
<p>零时科技安全团队建议设置AndroidManifest.xml的android:allowBackup标志为false。</p>
<h3 id="代码反编译检测"><a href="#代码反编译检测" class="headerlink" title="代码反编译检测"></a>代码反编译检测</h3><p>若app的apk文件可被反编译，就有可能导致源代码信息泄露，攻击者也可对其进行代码审计以找出可能存在隐患的攻击点。</p>
<p>零时科技安全团队对某交易所app进行安全测试时，通过检测apk文件是否通过加固，代码是否通过加密或者混淆，是否可以通过反编译攻击等方面对该app进行测试。发现该apk文件可被反编译，反编译后可以看到java源代码，导致源代码信息泄露。（通过jadx-gui或其他反编译工具可直接操作apk，查看java源代码。）</p>
<p><img src="./assets/4.png" alt="Decompile"></p>
<p>零时科技安全团队建议，可使用专业加固工具对apk进行加壳处理。</p>
<h3 id="敏感权限使用"><a href="#敏感权限使用" class="headerlink" title="敏感权限使用"></a>敏感权限使用</h3><p>目前很多系统在app请求权限这一方面上都不甚敏感，这也是如今移动端并不那么安全的成因之一。很多app都会请求一些敏感的权限，有的甚至会直接绕过，不向用户请求就直接自行取得了权限。而这些app有可能对交易所和用户都产生足够的恶意影响。</p>
<p>零时科技安全团队在对某交易所app进行安全测试时，检测APP程序中是否存在敏感权限的使用，发现确实存在敏感权限使用漏洞。</p>
<p><img src="./assets/5.jpg" alt="Authority control"> </p>
<p>敏感权限如下：</p>
<ul>
<li><p>android.permision.WRITE_EXTERNAL_STORAGE 允许应用写入外部存储</p>
</li>
<li><p>ndroid.permission.READ_PHONE_STATE 允许访问电话状态、设备信息</p>
</li>
<li><p>ndroid.permission.CAMERA 允许访问摄像头</p>
</li>
<li><p>android.permission.GET_TASKS 允许获取系统应用列表</p>
</li>
<li><p>android.permission.MOUNT_UNMOUNT_FILESYSTEMS 允许挂载、反挂载外部文件系统 </p>
</li>
</ul>
<p>零时科技安全团队建议禁用不需要的敏感权限。</p>
<h3 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h3><p>敏感信息泄露危害极大，如泄露出测试/管理员数据，参数注释信息等。但它又是一种危害虽大却又较容易避免的漏洞，只要开发人员多加注重安全意识即可避免大部分问题。</p>
<p>零时科技安全团队在对某交易所进行安全测试时，查找其 app 程序文件中是否存在敏感信息泄露（如源码中，备份文件中，xml 资源文件中等），发现确实存在敏感信息泄露漏洞，源码中泄露了微信公众号 appid 和 secretkey：</p>
<p><img src="./assets/6.png" alt="Decompile Code"></p>
<p>获取token：</p>
<p><img src="./assets/7.png" alt="Wechat"></p>
<hr>
<p><em>鉴于文章内容长度限制，本期内容将分为上、下篇，顺序放送。</em></p>

      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-App安全·上/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-用户认证/">交易所安全测试-用户认证</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:47:42.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-用户认证/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	

      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="0x07-用户认证"><a href="#0x07-用户认证" class="headerlink" title="0x07 用户认证"></a>0x07 用户认证</h1><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><p>用户认证安全方面的安全问题也许单单从技术层面上讲，并不是一种非常复杂的问题，因为解决起来并不怎么困难；但如果从交易所的实际交易业务层面来看，用户认证方面如果存在安全隐患，那将是非常可怕的。简单试想一下，如果一个黑客可以通过任意账号的用户认证，那这位攻击者会对那些账户里的余额做什么呢……</p>
<p>这只是用户认证安全问题的一个小例子，当然同类的问题还有很多，虽然不尽相同，但其破坏性影响是同样可怕的。零时科技安全团队已经对此类问题做了一些整理，详情可见以下的测试列表，建议各大交易所以此列表自查，规避不必要的安全风险。</p>
<h2 id="二、测试列表"><a href="#二、测试列表" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><blockquote>
<p><strong>用户认证</strong></p>
<ul>
<li>用户注册过程测试</li>
<li>用户登录过程测试</li>
<li>找回密码过程测试</li>
<li>设备解绑过程测试</li>
<li>验证码策略测试</li>
<li>帐户权限变化测试</li>
<li>帐户枚举测试</li>
<li>弱密码策略测试</li>
<li>口令信息加密传输测试</li>
<li>默认口令测试</li>
<li>帐户锁定机制测试</li>
<li>认证绕过测试</li>
<li>浏览器缓存测试</li>
<li>权限提升测试</li>
<li>授权绕过测试</li>
</ul>
</blockquote>
<h2 id="三、案例分析"><a href="#三、案例分析" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="口令信息加密传输测试"><a href="#口令信息加密传输测试" class="headerlink" title="口令信息加密传输测试"></a>口令信息加密传输测试</h3><p>“反正数据包也只是在用户和交易所之间传输的，口令要加密干什么”，可能有部分粗心大意的开发人员会这么想，但事实真的是这样吗？口令加密真的没有用吗？显而易见，事实当然不是这样的。但可能有的开发人员真的会这么想，所以口令信息不加密即传输成为了各大交易所中最常见的问题之一。</p>
<p>口令加密的好处很多，比如可在一定程度上防止爆破；比如用户登录交易所期间被中间人攻击时，攻击者截获的数据包中若没有明文口令信息，即可使攻击者无法轻易获取口令等等。零时科技安全团队在对某交易所进行测试时，发现该交易所的口令信息在传输时已被前端加密。零时科技团队安全研究员随即审计网站前端js代码，寻找登录/重置密码时需要提交的参数，并在找到后，按js内容要求构造未加密数据包向api请求，所幸该某交易所对非加密数据包也敞开怀抱，即使是明文数据包，只要参数正确也可发挥作用。最后通过该漏洞和其他漏洞配合，成功登进其他用户账户。</p>
<p>零时科技安全团队建议，各大交易所在传输口令信息时，能够使用加密传输的方式，且最好不要留下加密算法的明显线索（加密用何种算法，密钥是什么等），保障信息安全。</p>
<p><img src="./assets/1.png" alt="明文传输"></p>
<h3 id="用户登录过程测试"><a href="#用户登录过程测试" class="headerlink" title="用户登录过程测试"></a>用户登录过程测试</h3><p>爆破，即暴力破解，意指使用大量可能有效的潜在答案一一尝试，最后留下确实有效答案的攻击手法。爆破虽然笨重但却经常有效；虽然常有奇效，但也确实要和某些其他问题合作才能发挥功能。</p>
<p>零时科技安全团队对某交易所进行安全测试时，发现该交易所的某交易所在账号登录处存在问题，虽然限制每个用户的登录试错次数，但并不限制同一IP对不同用户尝试登录的请求数量。零时科技安全研究员随即对该交易所实施了撞库攻击，最终成功破解出部分用户口令。</p>
<p>零时科技安全团队建议，各大交易所在登录页面应同时使用图形或更复杂的验证码；对同一IP发出的请求频率和数量进行限制。</p>
<p><img src="./assets/2.png" alt="撞库"></p>
<h3 id="验证码策略"><a href="#验证码策略" class="headerlink" title="验证码策略"></a>验证码策略</h3><p>验证码在某些情况下有着极强的安全作用，但如若使用不当或有所疏漏，也会留下安全隐患。看似有验证码放心了不少，其实有可能只是一件“皇帝的新衣”。零时科技安全团队在对某交易所进行安全测试时发现，该交易所在手机登录处需要向用户发送验证码并进行校验。该交易所验证码长度6位，貌似安全性较高，但实则可发现具有递增趋势且递增速度缓慢，爆破验证码时可以轻易确认当前验证码所在范围。对于交易所来说，这样的验证码机制就是“皇帝的新衣”；对于攻击者来说，更降低了攻击成本，提高了攻击效率。</p>
<p>零时科技安全团队建议各大交易所使用验证码保障自身安全时，应使用随机多位的验证码，有条件的话最好使用字母和数字混杂的高强度验证码，并限制验证码输入错误的次数，采取一定措施。</p>
<p><img src="./assets/3.png" alt="验证码爆破"></p>
<hr>
<p><strong>假作真时真亦假，但凭伪造之证，信手指鹿为马，登堂入室。尔用户之安危，岂非人为刀俎，我为鱼肉乎？</strong></p>
<p><em>注：以上所有测试均已经过相关交易所授权，请勿自行非法测试。</em></p>

      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-用户认证/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-接口安全/">交易所安全测试-接口安全</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:46:47.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-接口安全/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	

      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="0x06-接口安全"><a href="#0x06-接口安全" class="headerlink" title="0x06 接口安全"></a>0x06 接口安全</h1><h2 id="一-、概述"><a href="#一-、概述" class="headerlink" title="一 、概述"></a>一 、概述</h2><p>API，英文全称Application Programming Interface，翻译为“应用程序编程接口”。是一些预先定义的函数，目的是提供应用程序与开发人员基于某软件或硬件得以访问一组例程的能力，而又无需访问源码，或理解内部工作机制的细节。 由于其快速、有效和安全、可靠 的特性，被开发人员广泛的使用。但如果接口本身没有做好安全防护或者调用时没有做好频率限制，都会导致问题的出现。</p>
<p>零时科技安全团队在经过大量对交易所的测试后，总结出了针对各类接口的测试列表，如RPC、Web Service、RESTful API和GraphQL等。下面案例分析中将会详细讲述有关交易所存在的接口安全问题。</p>
<h2 id="二、测试列表"><a href="#二、测试列表" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><p><strong>接口安全</strong></p>
<ul>
<li>RPC安全测试<ul>
<li>RMI远程命令执行</li>
<li>CORS</li>
</ul>
</li>
<li>Web Service安全测试<ul>
<li>SQL注入</li>
<li>信息泄露</li>
</ul>
</li>
<li>GraphQL安全测试<ul>
<li>未授权访问</li>
<li>信息泄露</li>
<li>GraPhQL SQL注入</li>
<li>嵌套查询DOS</li>
</ul>
</li>
<li>RESTful API安全测试</li>
<li>数值精度测试</li>
<li>接口频率限制测试<ul>
<li>邮箱验证接口</li>
<li>短信验证接口</li>
<li>批量刷单</li>
</ul>
</li>
<li>超时检测</li>
</ul>
<h2 id="三、案例分析"><a href="#三、案例分析" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="数值精度测试"><a href="#数值精度测试" class="headerlink" title="数值精度测试"></a>数值精度测试</h3><p>零时科技安全团队对某交易所进行测试时发现，其默认小数点精度为4位小数点，大于4位小数的会往前四舍五入，比如0.9999系统会默认为1，由于此精度问题，导致可被攻击者薅羊毛。</p>
<p>攻击者可以开两个账号，一个挂单（无需认证即可挂单），一个出售，配合无限薅羊毛。</p>
<p>虽然单次获取收益很小，但是无限制的话，收益还是不错的。</p>
<p>通过大量无限制刷单，可以套取系统中心账号代币，攻击者可以出售代币套现跑路。</p>
<p>如下图所示，批量下单0.9999个代币，当15分钟后，系统默认取消交易，然后钱包中心钱包将返回1个代币给卖家，获取额为代币：</p>
<p><img src="./assets/jingdu.png" alt="精度刷取代币"></p>
<p>建议严格按照4位小数精度进行算术运算，并对下单频率以及数量进行限制。</p>
<h3 id="接口频率限制测试"><a href="#接口频率限制测试" class="headerlink" title="接口频率限制测试"></a>接口频率限制测试</h3><h4 id="邮箱验证接口"><a href="#邮箱验证接口" class="headerlink" title="邮箱验证接口"></a>邮箱验证接口</h4><p>在进行身份甄别时，邮箱验证码因其免费的缘故被广泛使用。但是在开发过程中没有正确的限制接口频率，就可能被利用进行电子邮箱炸弹攻击。电子邮件炸弹是最古老的匿名攻击之一，通过设置一台机器不断的大量的向同一地址发送电子邮件，攻击者能够耗尽接受者网络的宽带。 </p>
<p><img src="./assets/email.png" alt="Email Bomb"></p>
<h4 id="短信验证接口"><a href="#短信验证接口" class="headerlink" title="短信验证接口"></a>短信验证接口</h4><p>与上述所说的邮箱验证相同，因为短信验证的方便快捷以及安全性较高也被广泛的用于身份验证中。与邮箱验证不同的是，短信验证码的条数是需要按照数量付费的。如果未进行合理频率限制会导致：</p>
<ul>
<li><p>持续给手机号发送垃圾短信，造成极差的用户体验。</p>
</li>
<li><p>对于公司来说，发送短信一般借助第三方运营商，每条短信需要支付费用，如果一天被刷几十万条，一天造成上万的亏损。</p>
</li>
</ul>
<p><img src="./assets/sms.png" alt="SMS Bomb"></p>
<h4 id="批量刷单"><a href="#批量刷单" class="headerlink" title="批量刷单"></a>批量刷单</h4><p>零时科技安全团队在对某交易所进行安全测试时发现，可不停购买数量为负数的代币，然后确认付款，在商家后台无法进行确认收款，可以批量生产垃圾订单，而且会导致短信炸弹。请求如下：</p>
<p><img src="./assets/shuadan.png" alt="批量刷单"></p>
<p>此漏洞是由于可以接受非法参数以及未作频率限制共同造成。不仅影响到业务流程的正常运转，而且耗费了大量的短信资源。这种类似于薅羊毛的技术单次看来危害较小，所以经常会被忽略，但如果被无限制的利用，羊毛出在羊身上，终有秃噜皮的一天。</p>
<hr>
<p><strong>君子生非异也，善假于物也。</strong></p>
<p><strong>诚然，善于调用各种接口会大幅提高开发效率，但在使用前应充分了解接口的运作机制，进行合理的调用限制。</strong></p>
<p><strong>免得猛虎下山，反噬其主。</strong>  </p>
<p><em>注：以上所有测试均已经过相关交易所授权，请勿自行非法测试。</em></p>

      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-接口安全/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-安全配置/">交易所安全测试-安全配置</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:45:52.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-安全配置/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	

      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="0x05-安全配置"><a href="#0x05-安全配置" class="headerlink" title="0x05 安全配置"></a>0x05 安全配置</h1><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><p>服务端是一种专门为某一客户端设立的，具有针对性的程序，通常都只具备认证与传输数据功能。比如游戏服务端，就是专门为游戏客户端提供服务的，服务的内容包括为客户端提供登录服务，保存游戏玩家资料，提供玩家在线游戏等。而游戏客户端的登陆，就需要服务端的授权，服务器登录要是存在问题，就会使得其他人可以进入服务端，进而引发信息泄露，严重者甚至可能破坏服务端安全配置。由此，服务端安全配置的安全问题不可小视。</p>
<p>服务端配置安全，是保障网站安全性的第一步也是最重要的一步，以下为零时科技安全团队被授权测试交易所的相关测试项及部分案例。</p>
<h2 id="二、测试列表"><a href="#二、测试列表" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><p><strong>服务端安全配置</strong></p>
<ul>
<li><p>后端服务组件配置测试</p>
</li>
<li><p>服务器登录安全测试</p>
</li>
<li><p>文件扩展名解析测试</p>
</li>
<li><p>备份文件测试</p>
</li>
<li><p>测试文件测试</p>
</li>
<li><p>测试接口暴露</p>
</li>
<li><p>HTTP方法测试</p>
</li>
<li><p>Web前端跨域策略测试</p>
</li>
<li><p>Web安全响应头部测试</p>
</li>
<li><p>弱SSL/TLS加密，不安全数据传输测试</p>
</li>
<li><p>非加密信道传输敏感数据测试</p>
</li>
<li><p>弱口令及默认口令探测</p>
</li>
<li><p>管理后台发现</p>
</li>
</ul>
<h2 id="三、案例分析"><a href="#三、案例分析" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="HTTP方法测试"><a href="#HTTP方法测试" class="headerlink" title="HTTP方法测试"></a>HTTP方法测试</h3><p>WebDAV是一种一种基于 HTTP 1.1协议的通信协议，它支持GET、POST、HEAD、PUT、DELETE等HTTP方法，这些方法使应用程序可对Web Server直接读写，并支持写文件锁定及解锁，还可以支持文件的版本控制。</p>
<p>WebDAV虽然方便了网站管理员对网站的管理，但是也带来了新的安全风险。如PUT方法自身不带验证机制，利用PUT方法可以向服务器上传文件，所以恶意攻击者可以上传木马等恶意文件；DELETE方法可以删除服务器上特定的资源文件，造成恶意攻击等有害操作。所以如果要使用WebDAV，务必禁止不必要的HTTP 方法，以防被其他攻击者利用。</p>
<p>以下为零时科技安全团队在对交易所进行测试时，发现使用不安全的HTTP方法的案例。使用OPTIONS请求，可返回网站支持的HTTP方法，由图可看出网站开启了PUT，DELETE等有害方法。由于测试时及时反映给了厂商，厂商也及时进行了修复，故没有利用该漏洞进行下一步测试。</p>
<p>顾及到该漏洞危害巨大，如果各大交易所有此类开启不安全HTTP方法的网站，零时科技安全团队建议及时修复，以规避不必要的安全风险。</p>
<p><img src="./assets/1.png" alt=""></p>
<h3 id="管理后台探测"><a href="#管理后台探测" class="headerlink" title="管理后台探测"></a>管理后台探测</h3><p>网站管理后台对于测试人员来说都已经相当熟悉，稍微解释一下，管理后台是对网站数据库和文件的快速操作和管理系统，可使得前台内容能够得到及时更新和调整。管理后台的功能繁多而强大，每个恶意攻击者也会想尽办法攻进后台，而正所谓“能力越大责任越大”，一旦管理后台被恶意攻击者占领，基本也就宣布该权限下的“阵地”已经全部失守，所有数据也任人宰割。但由此也可见得后台保护的重要性，那么如何使得后台不被攻破呢？最简单的办法无非就是把后台藏起来了。所以网站后台的隐藏也就成了保护网站的重要步骤。</p>
<p>零时科技安全团队在对某交易所进行安全测试时，发现该交易所的管理后台地址为其子域名的admin的MD5形式。对后台进行弱口令测试后，发现确实存在弱口令，以此直接进入了后台，所有数据一览无余。</p>
<p>零时科技安全团队建议：各大交易所如有条件，可不将后台管理入口暴露在外网中或设置可登录的ip白名单；如不得不将后台管理入口置于外网，请尽量设置安全性高的验证码机制，使用安全性高的管理平台和复杂度足够的管理员密码，以规避不必要的风险。</p>
<p><img src="./assets/2.png" alt=""></p>
<h3 id="后台服务组件配置测试"><a href="#后台服务组件配置测试" class="headerlink" title="后台服务组件配置测试"></a>后台服务组件配置测试</h3><p>安全意识不佳的网站管理者在使用后台服务组件时可能会选择默认配置，并不做个性化的改动。而当今的很多漏洞想要被用来发挥破坏性，也需要破除很多此类的限制——在很多个性化的配置下，大多数的漏洞是无法应用的。</p>
<p>零时科技安全团队在对某交易所进行安全测试期间，发现访问该交易所的门户网站中不存在的目录时，由于该网站的管理员配置不当，网站会爆出一些敏感信息，如物理路径，真实IP等。这些信息会对攻击者的后续攻击提供便利，大大减少攻击难度，攻击成本。</p>
<p><img src="./assets/3.png" alt=""></p>
<h3 id="弱口令及默认口令探测"><a href="#弱口令及默认口令探测" class="headerlink" title="弱口令及默认口令探测"></a>弱口令及默认口令探测</h3><p>弱口令没有很明确的定义，一般指的是易被猜到或破解的口令。易被破解的如仅包含简单数字的”123456“；仅包含字母的”abcabc“，”qazwsx“等。易被猜到的如一些生日密码，姓名缩写密码，身份证后6位等。</p>
<p>默认口令是指很多网站后台密码或者用户密码为初始默认状态，并没有做二次更改的口令。例如：“admin”，“111111”，身份证后六位等。这种口令的易猜解易破解性，使得攻击成本与难度大大降低，攻击者有时可以轻易登录相关账号，进入用户账户或网站后台，获取非法权限，做出恶意操作。如对用户的相关信息进行更改，或发布一些恶意消息或文件；恶意修改网站信息和配置，导致网站信息混乱或攻击者借此拿到更高权限，进一步攻击等。</p>
<p>由此，对于相关工作人员安全意识的培养，对于弱口令及默认口令的及时修改和复杂度加强，就显得尤为重要，刻不容缓。</p>
<p>零时科技安全团队对交易所进行测试时，就曾经以猜解弱口令的方式直达后台，轻易拿下网站权限。正如前文所提到的关于安全意识的内容，一百个人里总有一个人在使用弱口令，而那一个人就会因为攻击成本如此低廉成为被攻击的目标。</p>
<hr>
<p><strong>配置之于安全，犹如水之就下。</strong></p>
<p><strong>非之，则如蚁穴之于千里之堤。</strong></p>
<p><strong>棋差一招，满盘皆输。</strong></p>
<p><strong>注：以上所有测试均已经过相关交易所授权，请勿自行非法测试。</strong></p>

      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-安全配置/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-输入输出/">交易所安全测试-输入输出</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:44:58.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-输入输出/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	

      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="0x04-输入输出"><a href="#0x04-输入输出" class="headerlink" title="0x04 输入输出"></a>0x04 输入输出</h1><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><p>输入输出的安全问题来源于开发人员编码过程中的粗心大意以及应有的安全意识的缺失。这些安全问题对于网站来说是非常严峻的，对数据库，网站管理权限，内网都有巨大威胁。而且利用手法很多，如利用任意文件上传漏洞可直接获取网站shell，利用命令执行漏洞可执行命令反弹shell，利用SQL注入漏洞可查看和修改数据库信息，利用服务端请求伪造（SSRF）漏洞可攻击内网等。因此关于输入输出的安全测试必不可少，并且是重中之重，丝毫不能疏忽和遗漏。以下是对交易所进行测试后列出的详细测试条目，以及一些存在输入输出安全问题的经典案例。</p>
<h2 id="二、测试列表"><a href="#二、测试列表" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><blockquote>
<p>输入输出安全</p>
<ul>
<li>跨站脚本（XSS）</li>
<li>模板注入测试</li>
<li>HTTP头注入测试</li>
<li>HTTP参数污染测试</li>
<li>不安全的HTTP方法测试</li>
<li>服务端请求伪造（SSRF）测试</li>
<li>任意文件上传</li>
<li>SQL注入测试</li>
<li>XXE实体化测试</li>
<li>反序列化漏洞测试</li>
<li>HTTP请求夹带（smuggling）攻击测试</li>
<li>代码注入测试</li>
<li>本地文件包含测试</li>
<li>远程文件包含测试</li>
<li>命令执行注入测试</li>
<li>缓冲区溢出测试</li>
<li>格式化字符串测试</li>
</ul>
</blockquote>
<h2 id="三、案例分析"><a href="#三、案例分析" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="跨站脚本（XSS）测试"><a href="#跨站脚本（XSS）测试" class="headerlink" title="跨站脚本（XSS）测试"></a>跨站脚本（XSS）测试</h3><p>跨站脚本（XSS）是最常见的web漏洞之一，亦是客户端脚本安全的头号大敌，在各大漏洞提交平台也经常见到XSS的漏洞提交。跨站脚本攻击的危害巨大且可利用处繁多：如XSS钓鱼，Cookie劫持，获取用户真实IP等操作。</p>
<p>零时安全实验室在对某交易所进行测试时，发现在资产充值的付款钱包地址处，可以输入任意字符，并没有对输入的字符进行过滤和编码。初步测试时弹框成功，进一步写入利用XSS获取cookie的脚本。等待一段时间后，成功获取到后台管理员cookie，并以此登录后台成功，其后台可进行任意转账和充值操作，且存在大量用户信息。</p>
<p>下图为测试XSS时截图：</p>
<p>​    <img src="./assets/1.png" alt="XSS PAYLOAD"></p>
<p>  成功弹框</p>
<p><img src="./assets/2.png" alt="XSS ALERT"></p>
<p>成功获取后台管理员cookie：</p>
<p><img src="./assets/3.png" alt="XSS GET COOKIE"></p>
<p>用管理员cookie登录后台</p>
<p><img src="./assets/4.png" alt="CONSOL LOG"></p>
<h3 id="SQL注入测试"><a href="#SQL注入测试" class="headerlink" title="SQL注入测试"></a>SQL注入测试</h3><p>数据库（SQL）对于开发者和网络安全人员来说，应该是非常熟悉了。OWASP TOP 10多次把数据库相关的SQL注入攻击列在榜首，也足以见得其危害。SQL注入漏洞的产生主要是因为Web应用程序对用户输入的数据没有进行合法性判断，攻击者可以控制前端传入到后端的参数，利用参数代入数据库查询，通过构造不同的SQL语句实现对数据库的任意操作。鉴于其危害性巨大，零时安全实验室在对交易所测试时，对SQL注入类漏洞会进行全面细微的排查。</p>
<p>零时安全实验室被授权测试某交易所时，在一个提交GET请求的数据包中，发现疑似的注入点。进行手工测试后，验证存在延时注入，后使用工具进一步测试，得到了数据库表，用户名，密码等数据库存储的相关信息。</p>
<p>下图为手工注入测试过程：</p>
<p><img src="./assets/5.png" alt="SQLI"></p>
<p>工具测试过程：</p>
<p><img src="./assets/6.png" alt="SQLMAP"></p>
<h3 id="代码注入测试"><a href="#代码注入测试" class="headerlink" title="代码注入测试"></a>代码注入测试</h3><p>代码注入漏洞与SQL注入漏洞同隶属于注入类型，其危害也相当巨大，是经常被攻击者能用来拿下网站权限的“利器”。这种漏洞的产生大多是因为部分开发人员的编程习惯并不安全，例如经常使用一些类似于eval()，system()的危险函数等。下面用一个实例说明一下此类漏洞的危害。</p>
<p>零时安全实验室在对某交易所进行测试时，发现交易所的某相关域名下报错信息提示中间件及版本为Thinkphp 5.0.11，随即利用其已公开的一个代码执行漏洞写入shell，连接成功后拿下网站权限。</p>
<p>访问网站不存在的目录，管理员开启了debug信息：</p>
<p><img src="./assets/7.png" alt="DEBUG"></p>
<p>根据ThinkPHP相关版本漏洞，验证漏洞是否存在，可以看到禁用方法：</p>
<p><img src="./assets/8.png" alt="PHPINFO"></p>
<p>写入木马后，连接成功，拿到网站管理员权限：</p>
<p><img src="./assets/9.png" alt="ANTSWORD"></p>
<hr>
<p><strong>人和机器总是要产生交互</strong></p>
<p><strong>交互就意味着危险</strong></p>
<p><strong>有输入输出的地方就是危险的多发地</strong></p>
<p><em>注：以上所有测试均已经过相关交易所授权，请勿自行非法测试。</em></p>

      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-输入输出/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-信息泄漏/">交易所安全测试-信息泄漏</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:43:29.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-信息泄漏/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	

      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="0x03-信息泄露"><a href="#0x03-信息泄露" class="headerlink" title="0x03 信息泄露"></a>0x03 信息泄露</h1><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><p>信息泄露在安全审计中屡见不鲜，对于存有大量用户KYC信息的交易所来说影响更加深远，是非常严重的安全问题。零时科技安全团队在审计大量交易所后发现，信息泄露问题一般集中于交易所的账户体系、OTC交易系统、用户订单、邀请列表和网站源代码等地方。造成信息泄露的主要原因一般是由于服务器响应包内容没有经过处理就将用户的所有信息返回，配合其他漏洞甚至可以批量的获取用户敏感信息，除此以外，对善于掘金的攻击者来说网站前端源码可谓是遍地黄金，大量敏感信息的注释（测试账户、内网IP、测试地址、测试token等等）没有在进入生产环境时被删除。</p>
<h2 id="二、测试列表"><a href="#二、测试列表" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><blockquote>
<p>信息泄露</p>
<ul>
<li>KYC信息泄露<ul>
<li>登录注册</li>
<li>忘记密码</li>
<li>邀请列表</li>
<li>OTC交易系统</li>
<li>用户订单</li>
</ul>
</li>
<li>前端源码信息泄露<ul>
<li>测试数据泄露</li>
<li>敏感信息泄露</li>
<li>API接口泄露</li>
</ul>
</li>
<li>Github信息泄露<ul>
<li>数据库文件/连接凭据</li>
<li>敏感信息泄露</li>
</ul>
</li>
<li>敏感文件信息泄露<ul>
<li>robots.txt</li>
<li>crossdomain.xml</li>
<li>sitemap.xml</li>
<li>.git/.svn/.bak</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="三、案例分析"><a href="#三、案例分析" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="KYC信息泄露"><a href="#KYC信息泄露" class="headerlink" title="KYC信息泄露"></a>KYC信息泄露</h3><p>在业务逻辑文章中曾经讲过KYC认证缺陷 ，指的是用虚假以及非法的信息来绕过交易所的KYC认证。而对于使用真实KYC信息认证的用户，KYC信息本身的安全性显得尤为重要。</p>
<h4 id="忘记密码"><a href="#忘记密码" class="headerlink" title="忘记密码"></a>忘记密码</h4><p>某交易所在用户忘记密码时未对响应包进行处理，当输入邮箱或者电话号码进行找回密码操作时，服务器将用户的uid、mobile、name、nickname、email、qq、wexin、identitycardnon（身份证号）以及googlesecret一并返回，造成了极其严重的KYC信息泄露：</p>
<p><img src="./assets/zhmm.png" alt="找回密码泄露用户信息" title="找回密码泄露用户信息"></p>
<h4 id="邀请列表"><a href="#邀请列表" class="headerlink" title="邀请列表"></a>邀请列表</h4><p>某交易所在用户查看邀请人列表时没有对服务器响应包内容进行处理，导致查看邀请列表时会泄露所有被邀请人的KYC信息包括uid、mobile、name、nickname、email、qq、wexin、identitycardnon（身份证号）以及googlesecret等。利用存在的越权漏洞，可以遍历收集所有被邀请用户的KYC信息：</p>
<p><img src="./assets/yqlb.png" alt="邀请列表KYC信息泄露" title="邀请列表KYC信息泄露"></p>
<p><em>注：由于敏感性原因暂不放出收集结果以及具体细节</em></p>
<h4 id="OTC查看商家-订单"><a href="#OTC查看商家-订单" class="headerlink" title="OTC查看商家/订单"></a>OTC查看商家/订单</h4><p>某交易所在用户查看OTC订单处存在信息泄露，服务器的响应包里将商家的id、qq、alipay、whatsApp、nickname、mobile、wechat、telegram、username、realname、skype和email全部返回，只要遍历订单就可以获得所有商家的个人信息：</p>
<p><img src="./assets/otcsj.png" alt="OTC信息泄露" title="OTC商家信息存在信息泄露"></p>
<h4 id="信息泄露攻击链"><a href="#信息泄露攻击链" class="headerlink" title="信息泄露攻击链"></a>信息泄露攻击链</h4><p>零时科技安全团队在对某交易所进行安全测试时发现，该交易所在用户查看OTC商家的信息时，遍历userid便可以获得所有商家用户的phone、username和nickname。收集到所有泄露的商家phone后，经过测试又在忘记密码处发现信息泄露，只要输入手机号就可以获得商家的userid以及email，通过两个信息泄露漏洞构成的攻击链同时进行收集，最终收集到所有商家用户的真实姓名、电话号码、邮箱地址以及昵称。</p>
<p>下图为通过遍历userid获取所有商家的phone和username:</p>
<p><img src="./assets/otcsj1.png" alt="商户信息泄露"></p>
<p>下图为通过收集到的手机号码来获取商家的email以及userid:</p>
<p><img src="./assets/wjmm.png" alt="找回密码信息泄露"></p>
<p>也许某个点的信息泄露看起来微不足道，一旦点与点之间连成线，对于攻击者来说这两个点确定的可不只是一条有始有终的线段，而当这条攻击链被利用起来的时候，便是条有始无终，直至目标的射线。</p>
<h3 id="源码信息泄露"><a href="#源码信息泄露" class="headerlink" title="源码信息泄露"></a>源码信息泄露</h3><p>在开发过程中，开发与测试人员为了能够更加轻松地了解以及调试代码，通常在开发与测试阶段在代码中留下大量注释信息，其中不乏有测试用IP地址，测试端口，测试用账户，测试用token和测试用API等等。</p>
<p>编写注释对于广大开发与测试人员可以提高代码的易读性以及开发效率，可算是与人方便，与己方便的好习惯。可一旦这些方便的注释经过开发环境、测试环境到达了生产环境，在公网上暴露出来，方便的可就不只是兢兢业业的开发者与测试者，还有在黑暗中隐藏行踪，时刻紧盯着目标的攻击者们。</p>
<p>在经过对大量交易所测试后发现，开发与测试人员可能是世界上最具有开源精神的一批人，有的喜欢将自家网站的内网拓扑以及测试接口开源出来供大家欣赏。</p>
<p>某交易所源代码中存有大量含有测试用接口，IP地址的注释：</p>
<p><img src="./assets/sourcecode.png" alt="测试用接口，IP地址" title="源代码中存在信息泄露"></p>
<p>有些喜欢将自家的加密的密钥开源出来供大家使用。</p>
<p>某交易所源代码中含有AES加密的硬编码密钥，导致数据加密被破解：</p>
<p><img src="./assets/AES.png" alt="AES加密密钥"></p>
<p>而有些不仅直接将自家测试用token放到源码里，还向账户里进行充值，可谓是：“弱水三千，任君自取”，不过君是不是“只取一瓢饮”那可就不知道了。</p>
<p>某交易所源码中含有测试用JWT，修改后可成功登录账户，控制资产：</p>
<p><img src="./assets/JWT.png" alt="源码中含有测试用JWT"></p>
<p>使用测试用JWT登录账户，控制资产：</p>
<p><img src="./assets/JWT1.png" alt="测试用JWT登录账户"></p>
<p>诚然，详细而又全面的注释是开发与测试人员良好的代码编写习惯，不过要记得在经过开发环境与测试环境后，进入生产环境之前，将所有可能会暴露到外界的含有敏感信息注释删除，以防敏感信息泄露。在GitHub上开源是好事，但也要记得上传之前仔细检查，不要将自家的数据库地址与密码一同开源出去。</p>
<hr>
<p><strong>对于交易所来说，不辜负用户的信赖，保护好用户给予的个人信息，应该是安身立命之本。</strong></p>
<p><strong>对于开发人员来说，要做好差别对待，保护好代码安全，给用户良好体验的同时，不要攻击者有着同样良好的渗透体验。</strong><br><em>注：以上所有测试均已经过相关交易所授权，请勿自行非法测试。</em></p>

      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-信息泄漏/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-业务逻辑/">交易所安全测试-业务逻辑</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:42:26.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-业务逻辑/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	

      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="0x02-业务逻辑"><a href="#0x02-业务逻辑" class="headerlink" title="0x02 业务逻辑"></a>0x02 业务逻辑</h1><h2 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h2><p>对于交易所来说，一个逻辑完备，鉴权完整的交易流程必不可少。业务逻辑漏洞独立与其他服务却又容易受到其他安全问题的牵扰。与SQL注入、XSS等常规web安全漏洞不同，业务逻辑漏洞使用正常的业务流程中的程序固有不足，逻辑设计缺陷等进行攻击，甚至绕过已有安全防护措施，一般防护手段以及安全设备无法防御，因此业务逻辑漏洞一直困扰着广大开发者和安全测试人员。这里给出在经过大量对交易所安全测试后总结出的详细的测试条目，拿出具体案例和大家一起分析存在的安全问题。</p>
<h2 id="二、测试列表"><a href="#二、测试列表" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><blockquote>
<p>业务逻辑审计 </p>
<ul>
<li><p>越权操作测试</p>
<ul>
<li>订单越权发起、查看、编辑、删除</li>
<li><p>地址越权添加、删除</p>
</li>
<li><p>用户信息越权查看、编辑</p>
</li>
</ul>
</li>
<li>工作流程绕过测试</li>
<li>KYC认证缺陷测试<ul>
<li>接口识别</li>
<li>人工识别</li>
</ul>
</li>
<li>OTC逻辑缺陷测试</li>
<li>数值精度测试</li>
<li>资产安全测试<ul>
<li>充值</li>
<li>提现</li>
</ul>
</li>
<li>二次验证绕过测试<ul>
<li>Google验证器</li>
<li>手机及邮箱验证吗</li>
</ul>
</li>
<li>盘口价格设置缺陷测试</li>
<li>假充值测试</li>
<li>短地址攻击测试</li>
<li>数值精度测试</li>
</ul>
</blockquote>
<h2 id="三、案例分析"><a href="#三、案例分析" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="越权操作"><a href="#越权操作" class="headerlink" title="越权操作"></a>越权操作</h3><p>可能是因为开发人员热衷于打破樊篱 ，所以越权一直是Web安全中老生常谈的问题，并且由于订单、地址、余额和个人信息等等功能的聚集，交易所是越权问题的重灾区。越权漏洞一般分为平行越权和垂直越权两种，而交易所中平行越权占大多数，不仅可以导致越权查看、修改、撤销订单，添加、删除地址以及修改个人信息，而且配合存在的信息泄露问题，可以变相的获取所有用户的KYC信息，因为是正常请求，比起脱裤更难被WAF所发现。</p>
<p>某交易所修改userPhone可以越权让任意用户下单：</p>
<p><img src="./assets/yqxd.png" alt="越权下单" title="越权下单"></p>
<p>某交易所遍历id可以越权删除地址：</p>
<p><img src="./assets/yqscdz.png" alt="越权删除地址" title="越权删除地址">WS东京机房硬件设备故障，导致无法连接到服务。部分交易所因使用其他交易所错误的价格数据导致币价出现剧烈波动，BTC成交价最低为0.32USD/BTC，ETH以及EOS均受到影响。</p>
<p><img src="./assets/0.32USDBTC.png" alt="0.32USDBTC"></p>
<p>在上游数据错误的情况下，没有对数据的有效性进行判断直接使用导致损失的出现。</p>
<p>在传统安全行业我们称之为供应链攻击，一旦上游的数据、厂商被劫持，修改，对下游没有做好防护措施的交易所将会造成降维打击。</p>
<hr>
<p><strong>没有绝对安全的系统</strong></p>
<p><strong>因为代码之后是人的逻辑</strong></p>
<p><em>注：以上所有测试均已经过相关交易所授权，请勿自行非法测试。</em></p>
<p>根据上述示例可以看出，虽然请求头中含有token和userId等参数，但服务器在接受到请求后并没有将token和userId与body里所携带的id和userPhone进行校验，没有做好鉴权，导致越权。  </p>
<h3 id="工作流程绕过"><a href="#工作流程绕过" class="headerlink" title="工作流程绕过"></a>工作流程绕过</h3><p>近期零时安全团队在某交易所发现一起由于越权、信息泄露以及工作流程绕过导致的盗币事件。因为事件发生时间太近，不确定厂商是否修复完毕，这里不再披露详细的攻击细节以及截图，简单讲一讲攻击手法。</p>
<p>攻击者在某交易所前端文件中发现了转账时所调用的API接口。按照流程，用户验证身份通过后调用此API转账，但由于验证在前，转账在后，两者并非同时进行，导致攻击者直接调用转账API接口发起转账可以直接绕过身份验证并且可以越权其他用户进行转账。  </p>
<p><img src="./assets/rglc.png" alt="绕过流程"></p>
<p>造成本次攻击事件的主要原因有三：</p>
<blockquote>
<ul>
<li>前端文件泄露API接口</li>
<li>交易时验证逻辑可被绕过</li>
<li>未能做好鉴权措施</li>
</ul>
</blockquote>
<p>暴露意味着更大的攻击面。隐藏好自己的信息，完备逻辑，完整鉴权，来应对还在潜伏着的威胁。</p>
<h3 id="KYC认证缺陷"><a href="#KYC认证缺陷" class="headerlink" title="KYC认证缺陷"></a>KYC认证缺陷</h3><p>KYC全称为know-your-customer,  充分了解你的客户 ，了解账户的实际控制人和交易的实际收益人，还要求对客户的身份、常住地址或企业所从事的业务进行充分的了解，并采取相应的措施。</p>
<p>认证作为交易所的重要功能之一，认证方式也百花齐放，常见的有身份证正反面照片，手持身份证照片，手持身份证视频等等。而认证方式有人工识别和接口识别两种，人工识别的准确性取决于审核员当天的心情以及前一天的睡眠，PS加AI换脸的手持身份证照片一般来说可以轻松通过。对于调用接口来进行识别的，有使用百度识图接口来验证，判断身份证照片上的身份证号以及姓名与用户输入的是否相同，来判断是否通过；有需要用户自己掏两块钱来审核的支付宝的人脸识别接口。<br>下图为某交易所调用baidu API进行KYC认证的前端代码：</p>
<p><img src="./assets/kycjs.png" alt="某交易所调用baidu api进行KYC认证的前端代码" title="某交易所调用baidu api进行KYC认证的前端代码"></p>
<p>对于这种形同虚设KYC认证方式，掌握画图的初级使用技巧即可可以轻松绕过。</p>
<h3 id="OTC逻辑缺陷"><a href="#OTC逻辑缺陷" class="headerlink" title="OTC逻辑缺陷"></a>OTC逻辑缺陷</h3><p>OTC指的是Over-the-counter，场外交易市场， 通常是指店头交易市场或柜台交易市场 。对于交易所来说，OTC指的是用户依托交易所的担保，卖家和买家进行交易。</p>
<p>正常OTC交易流程为：</p>
<blockquote>
<p>商家卖币  =&gt;  买家购买币并支付 =&gt; 商家确认收款 =&gt; 系统转账到买家。</p>
</blockquote>
<p>而攻击者通过越权：</p>
<blockquote>
<p>商家卖币 =&gt;  攻击者购买币并不支付 =&gt;  攻击者通过越权点击商家的确认收款  =&gt;  系统转账到买家。</p>
</blockquote>
<p>图下为某交易所OTC存在的逻辑缺陷：</p>
<p><img src="./assets/OTCattack.png" alt="OTC攻击流程" title="OTC攻击流程"></p>
<p>利用此类逻辑问题，攻击者可以轻易的不进行支付而直接获得系统转账。此类问题在零时科技安全团体对交易所客户进行安全审计时多次出现，对交易所带来直接的经济损失。</p>
<h3 id="二次验证绕过"><a href="#二次验证绕过" class="headerlink" title="二次验证绕过"></a>二次验证绕过</h3><p>在安全审计过程中，交易所的二次验证有使用Google验证码以及手机和邮箱验证码，二次验证就是为了保障用户账号安全，已经敏感操作的确认，但是由于设计缺陷将导致二次验证形同虚设。</p>
<p>在工作流程绕过中谈过，如果支付验证与转账操作分为两步进行，就一定需要在转账时对当前用户进行验证以及鉴权来防止绕过和越权。零时科æ安全团队对大量交易所进行安全审计时发现，大部分交易所进行转账等敏感操作二次验证时，将验证操作与转账操作通过不同接口隔离实现，导致验证码结构脱离转账操作，失去二次验证的效</p>
<h1 id="0x02-业务逻辑-1"><a href="#0x02-业务逻辑-1" class="headerlink" title="0x02 业务逻辑"></a>0x02 业务逻辑</h1><h2 id="一、概述-1"><a href="#一、概述-1" class="headerlink" title="一、概述"></a>一、概述</h2><p>对于交易所来说，一个逻辑完备，鉴权完整的交易流程必不可少。业务逻辑漏洞独立与其他服务却又容易受到其他安全问题的牵扰。与SQL注入、XSS等常规web安全漏洞不同，业务逻辑漏洞使用正常的业务流程中的程序固有不足，逻辑设计缺陷等进行攻击，甚至绕过已有安全防护措施，一般防护手段以及安全设备无法防御，因此业务逻辑漏洞一直困扰着广大开发者和安全测试人员。这里给出在经过大量对交易所安全测试后总结出的详细的测试条目，拿出具体案例和大家一起分析存在的安全问题。</p>
<h2 id="二、测试列表-1"><a href="#二、测试列表-1" class="headerlink" title="二、测试列表"></a>二、测试列表</h2><blockquote>
<p>业务逻辑审计 </p>
<ul>
<li><p>越权操作测试</p>
<ul>
<li>订单越权发起、查看、编辑、删除</li>
<li><p>地址越权添加、删除</p>
</li>
<li><p>用户信息越权查看、编辑</p>
</li>
</ul>
</li>
<li>工作流程绕过测试</li>
<li>KYC认证缺陷测试<ul>
<li>接口识别</li>
<li>人工识别</li>
</ul>
</li>
<li>OTC逻辑缺陷测试</li>
<li>数值精度测试</li>
<li>资产安全测试<ul>
<li>充值</li>
<li>提现</li>
</ul>
</li>
<li>二次验证绕过测试<ul>
<li>Google验证器</li>
<li>手机及邮箱验证吗</li>
</ul>
</li>
<li>盘口价格设置缺陷测试</li>
<li>假充值测试</li>
<li>短地址攻击测试</li>
<li>数值精度测试</li>
</ul>
</blockquote>
<h2 id="三、案例分析-1"><a href="#三、案例分析-1" class="headerlink" title="三、案例分析"></a>三、案例分析</h2><h3 id="越权操作-1"><a href="#越权操作-1" class="headerlink" title="越权操作"></a>越权操作</h3><p>可能是因为开发人员热衷于打破樊篱 ，所以越权一直是Web安全中老生常谈的问题，并且由于订单、地址、余额和个人信息等等功能的聚集，交易所是越权问题的重灾区。越权漏洞一般分为平行越权和垂直越权两种，而交易所中平行越权占大多数，不仅可以导致越权查看、修改、撤销订单，添加、删除地址以及修改个人信息，而且配合存在的信息泄露问题，可以变相的获取所有用户的KYC信息，因为是正常请求，比起脱裤更难被WAF所发现。</p>
<p>某交易所修改userPhone可以越权让任意用户下单：</p>
<p><img src="./assets/yqxd.png" alt="越权下单" title="越权下单"></p>
<p>某交易所遍历id可以越权删除地址：</p>
<p><img src="./assets/yqscdz.png" alt="越权删除地址" title="越权删除地址"></p>
<p>根据上述示例可以看出，虽然请求头中含有token和userId等参数，但服务器在接受到请求后并没有将token和userId与body里所携带的id和userPhone进行校验，没有做好鉴权，导致越权。  </p>
<h3 id="工作流程绕过-1"><a href="#工作流程绕过-1" class="headerlink" title="工作流程绕过"></a>工作流程绕过</h3><p>近期零时安全团队在某交易所发现一起由于越权、信息泄露以及工作流程绕过导致的盗币事件。因为事件发生时间太近，不确定厂商是否修复完毕，这里不再披露详细的攻击细节以及截图，简单讲一讲攻击手法。</p>
<p>攻击者在某交易所前端文件中发现了转账时所调用的API接口。按照流程，用户验证身份通过后调用此API转账，但由于验证在前，转账在后，两者并非同时进行，导致攻击者直接调用转账API接口发起转账可以直接绕过身份验证并且可以越权其他用户进行转账。  </p>
<p><img src="./assets/rglc.png" alt="绕过流程"></p>
<p>造成本次攻击事件的主要原因有三：</p>
<blockquote>
<ul>
<li>前端文件泄露API接口</li>
<li>交易时验证逻辑可被绕过</li>
<li>未能做好鉴权措施</li>
</ul>
</blockquote>
<p>暴露意味着更大的攻击面。隐藏好自己的信息，完备逻辑，完整鉴权，来应对还在潜伏着的威胁。</p>
<h3 id="KYC认证缺陷-1"><a href="#KYC认证缺陷-1" class="headerlink" title="KYC认证缺陷"></a>KYC认证缺陷</h3><p>KYC全称为know-your-customer,  充分了解你的客户 ，了解账户的实际控制人和交易的实际收益人，还要求对客户的身份、常住地址或企业所从事的业务进行充分的了解，并采取相应的措施。</p>
<p>认证作为交易所的重要功能之一，认证方式也百花齐放，常见的有身份证正反面照片，手持身份证照片，手持身份证视频等等。而认证方式有人工识别和接口识别两种，人工识别的准确性取决于审核员当天的心情以及前一天的睡眠，PS加AI换脸的手持身份证照片一般来说可以轻松通过。对于调用接口来进行识别的，有使用百度识图接口来验证，判断身份证照片上的身份证号以及姓名与用户输入的是否相同，来判断是否通过；有需要用户自己掏两块钱来审核的支付宝的人脸识别接口。<br>下图为某交易所调用baidu API进行KYC认证的前端代码：</p>
<p><img src="./assets/kycjs.png" alt="某交易所调用baidu api进行KYC认证的前端代码" title="某交易所调用baidu api进行KYC认证的前端代码"></p>
<p>对于这种形同虚设KYC认证方式，掌握画图的初级使用技巧即可可以轻松绕过。</p>
<h3 id="OTC逻辑缺陷-1"><a href="#OTC逻辑缺陷-1" class="headerlink" title="OTC逻辑缺陷"></a>OTC逻辑缺陷</h3><p>OTC指的是Over-the-counter，场外交易市场， 通常是指店头交易市场或柜台交易市场 。对于交易所来说，OTC指的是用户依托交易所的担保，卖家和买家进行交易。</p>
<p>正常OTC交易流程为：</p>
<blockquote>
<p>商家卖币  =&gt;  买家购买币并支付 =&gt; 商家确认收款 =&gt; 系统转账到买家。</p>
</blockquote>
<p>而攻击者通过越权：</p>
<blockquote>
<p>商家卖币 =&gt;  攻击者购买币并不支付 =&gt;  攻击者通过越权点击商家的确认收款  =&gt;  系统转账到买家。</p>
</blockquote>
<p>图下为某交易所OTC存在的逻辑缺陷：</p>
<p><img src="./assets/OTCattack.png" alt="OTC攻击流程" title="OTC攻击流程"></p>
<p>利用此类逻辑问题，攻击者可以轻易的不进行支付而直接获得系统转账。此类问题在零时科技安全团体对交易所客户进行安全审计时多次出现，对交易所带来直接的经济损失。</p>
<h3 id="二次验证绕过-1"><a href="#二次验证绕过-1" class="headerlink" title="二次验证绕过"></a>二次验证绕过</h3><p>在安全审计过程中，交易所的二次验证有使用Google验证码以及手机和邮箱验证码，二次验证就是为了保障用户账号安全，已经敏感操作的确认，但是由于设计缺陷将导致二次验证形同虚设。</p>
<p>在工作流程绕过中谈过，如果支付验证与转账操作分为两步进行，就一定需要在转账时对当前用户进行验证以及鉴权来防止绕过和越权。零时科æ安全团队对大量交易所进行安全审计时发现，大部分交易所进行转账等敏感操作二次验证时，将验证操作与转账操作通过不同接口隔离实现，导致验证码结构脱离转账操作，失去二次验证的效果果</p>

      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-业务逻辑/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-社会工程/">交易所安全测试-社会工程</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:41:20.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-社会工程/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/渗透测试/" title="渗透测试">渗透测试</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	社会工程学是信息收集技术的延伸和升级，是一种高级的信息利用手段。系统中最大的漏洞永远是人，社会工程学攻击则是一种高效利用这种漏洞的手段，它看似不起眼，也不专业，也没有技术性，但其实是最有效，最直接的攻击手段之一。面对机器，一样的输入只有一种结果；而面对人，一样的输入却有千万种不同的反馈，根据这些探索出更深层次的信息，正是社会工程学的魅力所在。以下是信息收集List和社会工程学在测试中大放异彩的案例，供大家参考。
      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-社会工程/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/交易所安全测试-信息收集/">交易所安全测试--信息收集</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2020-01-08T09:36:22.000Z" itemprop="datePublished">2020/01/08</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="https://blog.noneage.com/交易所安全测试-信息收集/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/渗透测试/" title="渗透测试">渗透测试</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	对于所有安全相关的测试来说，信息收集都是非常重要且必要的第一步，有时一次非常全面完善的信息收集甚至会占到一次渗透测试总工程量的的70%到80%，能为后续的工作节省大量精力，提供便利，数字货币交易所的安全测试也是一样，第一步的信息收集至关重要。本文将展示零>时科技安全团队的多年攻防经验，以及大量交易所客户真实案例，虽然见微知著，但是通过案例就可以了解到，在安全测试过程中数字货币交易所有什么样的信息可供黑客收集利用以及导致怎样的危害。其中几点将会被单独加以说明，以供参考。
      
    </div>
    <br>
    <br>
    <a href="https://blog.noneage.com/交易所安全测试-信息收集/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
    </div>
    
      <div id="page-nav" class="pagination">
	<span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next</a>
      </div>
    
  </section>

</div>

</div>

  </div>
  </div>



    <!-- BEGIN PRE-FOOTER -->
    <div class="pre-footer">
      <div class="container">
        <div class="row">
          <!-- BEGIN BOTTOM ABOUT BLOCK -->
          <div class="col-md-4 col-sm-6 pre-footer-col">
            <h2>About Us</h2>
            <p>深圳零时科技有限公司，专注于区块链安全领域。 <br><br> 公司团队由从事安全技术研究和安全服务多年且经验丰富的高级网络安全专家组成，为客户提供专业的安全服务和安全解决方案。</p>
          </div>
          <!-- END BOTTOM ABOUT BLOCK -->

          <!-- BEGIN BOTTOM CONTACTS -->
          <div class="col-md-4 col-sm-6 pre-footer-col">
            <h2>Contact</h2>
            <address class="margin-bottom-40">
              深圳市深南大道佳嘉豪商务大厦18A<br>
              西安市丈八一路汇鑫国际IBC-A座906<br>
              <br>
              Phone: 150-2922-9543<br>
              Email: <a href="mailto:support@noneage.com">support@noneage.com</a><br>
            </address>
          </div>
          <!-- END BOTTOM CONTACTS -->

	
          <!-- BEGIN TWITTER BLOCK --> 
	  <div class="col-md-2 col-sm-6 pre-footer-col">
                <img src="/metronic/assets/corporate/img/wechat.png" width="160px" hight="160px">
		<br>
                <center>微信公账号</center>
          </div>
          <div class="col-md-2 col-sm-6 pre-footer-col">
                <img src="/metronic/assets/corporate/img/zsxq.jpg" width="160px" hight="160px">
		<br>
                <center>知识星球</center>
          </div>
          <!--div class="col-md-4 col-sm-6 pre-footer-col">

	  <a data-tweet-limit="1" class="twitter-timeline"
	  href="https://twitter.com/computerlab_"
	  data-widget-id="678830341331820544">Tweets by @computerlab_</a>

	  <script>!function(d,s,id){var
	  js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

          </div-->
          <!-- END TWITTER BLOCK -->
	
        </div>
      </div>
    </div>
    <!-- END PRE-FOOTER -->

    <!-- BEGIN FOOTER -->
    <div class="footer">
      <div class="container">
        <div class="row">
          <!-- BEGIN COPYRIGHT -->
          <div class="col-md-6 col-sm-6 padding-top-10">
                  &copy; 2020 零时科技<br>
 <a href="javascript:;">Privacy Policy</a> | <a href="javascript:;">Terms of Service</a>
          </div>
          <!-- END COPYRIGHT -->
	  <!-- BEGIN SOCIAL -->
<div class="col-md-6 col-sm-6">
  <ul class="social-footer list-unstyled list-inline pull-right">
    
      <li><a href="https://github.com/noneage"><i class="fa fa-github"></i></a></li>
    
      <li><a href="https://twitter.com/NoneAgeOffical"><i class="fa fa-twitter"></i></a></li>
    
      <li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li>
    
  </ul>  
</div>
<!-- END SOCIAL -->

        </div>
      </div>
    </div>
    <!-- END FOOTER -->

  <!-- BEGIN CORE PLUGINS (REQUIRED FOR ALL PAGES) -->
<!--[if lt IE 9]>
<script src="/metronic/assets/plugins/respond.min.js"></script>
<![endif]--> 
<script src="/metronic/assets/plugins/jquery.min.js"></script>
<script src="/metronic/assets/plugins/jquery-migrate.min.js"></script>
<script src="/metronic/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="/metronic/assets/corporate/scripts/back-to-top.js"></script>
<script src="/metronic/assets/plugins/owl.carousel/owl.carousel.min.js"></script>
<script src="/metronic/assets/corporate/scripts/layout.js"></script>
<script src="/js/wow.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script type="text/javascript">
    jQuery(document).ready(function() {
        Layout.init();    
        Layout.initOWL();
        Layout.initTwitter();
        Layout.initFixHeaderWithPreHeader(); /* Switch On Header Fixing (only if you have pre-header) */
        Layout.initNavScrolling(); 
	new WOW().init();
    });
</script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE-SPECIFIC PLUGINS --> 







<!-- END PAGE-SPECIFIC PLUGINS --> 

<!-- BEGIN INTEGRATIONS -->





<!-- END INTEGRATIONS -->

</body>
</html>
